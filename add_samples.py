#!/usr/bin/env python3
import requests
import mwdblib


# ----------- CONSTANTS -----------
MALWARE_FAMILY = "njrat"
API_URL = "https://mb-api.abuse.ch/api/v1/"
QUERY = {"query": "get_siginfo", "signature": MALWARE_FAMILY, "limit": 50}

MWDB_API_URL = "http://localhost:8888/api/"
MWDB_USERNAME, MWDB_PASSWORD = "admin", "TO_COMPLETE_WITH_YOUR_PASSWORD"

# ----------- MAIN -----------
# definition of the MWDB API object
mwdb = mwdblib.MWDB(api_url=MWDB_API_URL, username=MWDB_USERNAME, password=MWDB_PASSWORD)

# fetching samples from MalwareBazaar API
resp = requests.post(API_URL, data=QUERY)
samples = resp.json()["data"]

# looping over samples
print(f"Found {len(samples)} samples.")
for sample in samples:
    print(sample)
    # COMPLETE HERE
